<% if (typeof messages !== 'undefined') { const __msgHtml = messages(); if (__msgHtml && __msgHtml.toString().trim()) { %>
  <div class="messages">
    <%- __msgHtml %>
  </div>
<% } } %>
<% if (errors) { %>
  <ul class="notice">
    <% errors.array().forEach(error => { %>
      <li><%= error.msg %></li>
    <% }) %>
  </ul>
<% } %>

<h1><%= title %></h1>

<div class="registration-container">
  <form method="post" action="/account/register" class="registration-form">
    <div class="form-group">
      <label for="accountFirstname">First Name:</label>
      <input 
        type="text" 
        id="accountFirstname" 
        name="account_firstname" 
        required 
        placeholder="Enter your first name"
        value="<%= locals.account_firstname %>"
      />
    </div>

    <div class="form-group">
      <label for="accountLastname">Last Name:</label>
      <input 
        type="text" 
        id="accountLastname" 
        name="account_lastname" 
        required 
        placeholder="Enter your last name"
        value="<%= locals.account_lastname %>"
      />
    </div>

    <div class="form-group">
      <label for="accountEmail">Email Address:</label>
      <input 
        type="email" 
        id="accountEmail" 
        name="account_email" 
        required 
        placeholder="Enter your email address"
        value="<%= locals.account_email %>"
      />
    </div>

    <div class="form-group password-group">
      <label for="password">Password:</label>
      <div class="password-requirements" style="margin-bottom: 0.5rem;">
        <span style="display: block; font-weight: 600; margin-bottom: 0.25rem;">Passwords must be at least 12 characters and contain at least 1 number, 1 capital letter and 1 special character</span>
        <ul>
          <li>Minimum 12 characters in length</li>
          <li>At least 1 capital letter (A-Z)</li>
          <li>At least 1 number (0-9)</li>
          <li>At least 1 special character (!@#$%^&*)</li>
        </ul>
      </div>
      <div class="password-input-wrapper">
        <input 
          type="password" 
          id="accountPassword" 
          name="account_password" 
          required 
          pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{12,}$"
          placeholder="Enter your password"
        />
        <button type="button" class="toggle-password" id="togglePassword">Show</button>
      </div>
    </div>

    <button type="submit" class="btn-register">Create Account</button>
  </form>

  <div class="login-link">
    <p>Already have an account? <a href="/account/login">Sign in here</a></p>
  </div>
</div>

<script>
  // Toggle password visibility
  document.getElementById('togglePassword').addEventListener('click', function(e) {
    e.preventDefault();
    const passwordInput = document.getElementById('accountPassword');
    const toggleBtn = this;
    
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      toggleBtn.textContent = 'Hide';
    } else {
      passwordInput.type = 'password';
      toggleBtn.textContent = 'Show';
    }
  });
</script>
